!function(r){var t={};function e(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return r[s].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=r,e.c=t,e.d=function(r,t,s){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:s})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"==typeof r&&r&&r.__esModule)return r;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var o in r)e.d(s,o,function(t){return r[t]}.bind(null,o));return s},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s=9)}([function(r){r.exports={logs:{errorLog:"error_",infoLog:"info_"},hostnameProd:"https://salty-cove-63363.herokuapp.com",hostnameUrlDev:"http://localhost:3000",Errors:{department:{DEP_00:{status:400,code:"DEP_00",message:"Error in getting all departments",field:"none"},DEP_01:{status:500,code:"DEP_01",message:"ID is not a number",field:"department_id"},DEP_02:{status:404,code:"DEP_02",message:"Don'exist department with this ID",field:"department_id"}},category:{CAT_00:{status:400,code:"CAT_00",message:"Error in getting all Categories",field:"none"},CAT_01:{status:404,code:"CAT_01",message:"Don't exist category with this ID.",field:"category_id"}},attribute:{ATT_00:{status:400,code:"ATT_00",message:"Error in getting attributes",field:"none"},ATT_01:{status:404,code:"ATT_01",message:"Don't exist attribute with this ID.",field:"attribute_id"}},products:{PRO_00:{status:400,code:"PRO_00",message:"Error in getting products",field:"none"},PRO_01:{status:404,code:"PRO_01",message:"Don't exist attribute with this ID.",field:"attribute_id"}},Auth:{AUT_02:{status:401,code:"AUT_02",message:"Access Unauthorized",field:"API-KEY"},AUT_01:{status:401,code:"AUT_01",message:" Authorization code is empty",field:"API-KEY"}},orders:{ORD_00:{status:400,code:"ORD_00",message:"Error in getting Orders",field:"none"},ORD_01:{status:404,code:"ORD_01",message:"Don't exist order with this ID.",field:"order_id"}},tax:{TAX_00:{status:400,code:"TAX_00",message:"Error in getting Tax",field:"none"},TAX_01:{status:404,code:"TAX_01",message:"Don't exist Tax with this ID.",field:"tax_id"}},shipping:{SHP_00:{status:400,code:"SHP_00",message:"Error in getting Shipping Region details",field:"none"},SHP_01:{status:404,code:"SHP_01",message:"Don't exist Shipping region with this ID.",field:"shipping_region_id"}},customer:{USR_00:{status:400,code:"USR_00",message:"Error in getting Customer details",field:"none"},USR_01:{status:400,code:"USR_01",message:"Email or Password is invalid.",field:"email/password"},USR_02:{status:400,code:"USR_02",message:"The field(s) are/is required.",field:"email/password/name"},USR_03:{status:400,code:"USR_03",message:"The email is invalid",field:"email"},USR_04:{status:400,code:"USR_04",message:"The email already exists.",field:"email"},USR_05:{status:400,code:"USR_05",message:"The email doesn't exist.",field:"email"},USR_06:{status:400,code:"USR_06",message:"this is an invalid phone number",field:"phone_number"},USR_07:{status:400,code:"USR_07",message:"this is too long <FIELD NAME>.",field:"any field"},USR_08:{status:400,code:"USR_08",message:"this is an invalid Credit Card.",field:"credit_card"},USR_09:{status:400,code:"USR_09",message:"The Shipping Region ID is not number",field:"shippiing_region_id"}},shopping_cart:{SHC_00:{status:400,code:"SHC_00",message:"Error in getting Shopping Cart ID",field:"none"},SHC_01:{status:404,code:"SHC_01",message:"Don't exist Shipping region with this ID.",field:"shipping_region_id"}}}}},function(r,t,e){var s=e(22),o=t.Logger={},n=e(0),u=new Date,a=u.getFullYear()+"-"+(u.getMonth()+1)+"-"+u.getDate()+".log";const i=function(r){try{s.mkdirSync(r)}catch(r){if("EEXIST"!=r.code)throw r}};i("logs"),i("logs/"+u.getFullYear()),i("logs/"+u.getFullYear()+"/"+(u.getMonth()+1)),i("logs/"+u.getFullYear()+"/"+(u.getMonth()+1)+"/"+u.getDate());var c=s.createWriteStream("logs/"+u.getFullYear()+"/"+(u.getMonth()+1)+"/"+u.getDate()+"/"+n.logs.infoLog+a,{flags:"a"}),d=s.createWriteStream("logs/"+u.getFullYear()+"/"+(u.getMonth()+1)+"/"+u.getDate()+"/"+n.logs.errorLog+a,{flags:"a"});o.info=function(r){var t=(new Date).toString()+" : "+r+"\n";c.write(t)},o.error=function(r){var t=(new Date).toString()+" : "+r+"\n";d.write(t)}},function(r,t){r.exports=require("express")},function(r,t,e){const s=e(4),o=e(7),n=e(1).Logger;e(6).config();const u=e(0);var a=s.createConnection({host:process.env.DatabaseHostname,user:process.env.DatabaseUsername,password:process.env.DatabasePassword,database:process.env.DatabaseName});a.connect(function(r){if(r)return n.error("Error in SQL Database connection : "+r),console.log(o.red("Error Connecting to Database")),new Error(u.Errors.databaseError);console.log(o.green("Database Connected!"))}),a.on("error",function(r){n.error("Error in DB connection : "+r),console.error.bind(o.yellow("connection error..."))}),r.exports=a},function(r,t){r.exports=require("mysql")},function(r,t,e){const s=e(0),o=e(1).Logger,n=e(8);r.exports=function(r,t,e){try{const u=r.headers["user-key"];if(void 0!==u){const a=u.split(" ")[0];n.verify(a,process.env.jwtSecretKey,(n,u)=>{if(!n)return r.user={customer_id:u.customer_id,email:u.email},e();o.error("Error unauthorized : "+n),t.status(s.Errors.Auth.AUT_02.status).send(s.Errors.Auth.AUT_02)})}else o.error("Invalid/missing Auth token"),t.status(s.Errors.Auth.AUT_01.status).send(s.Errors.Auth.AUT_01)}catch(r){return o.error("Error in auth middleware : "+r),e(new Error("error"))}}},function(r,t){r.exports=require("dotenv")},function(r,t){r.exports=require("chalk")},function(r,t){r.exports=require("jsonwebtoken")},function(r,t,e){var s=e(10),o=e(47)("it-asset-management:server"),n=e(48),u=e(7),a=function(r){var t=parseInt(r,10);if(isNaN(t))return r;if(t>=0)return t;return!1}(process.env.PORT||"3000");s.set("port",a);var i=n.createServer(s);i.listen(a),i.on("error",function(r){if("listen"!==r.syscall)throw r;var t="string"==typeof a?"Pipe "+a:"Port "+a;switch(r.code){case"EACCES":console.error(t+" requires elevated privileges"),process.exit(1);break;case"EADDRINUSE":console.error(t+" is already in use"),process.exit(1);break;default:throw r}}),i.on("listening",function(){var r=i.address();console.log(u.yellow("App started on port : "+r.port));var t="string"==typeof r?"pipe "+r:"port "+r.port;o("Listening on "+t)})},function(r,t,e){const s=e(11),o=e(2),n=(e(12),e(13)),u=e(14),a=e(15),i=e(16),c=e(17),d=e(18),g=e(19),l=o(),p=e(20),_=e(24),E=e(27),m=e(30),y=e(33),f=e(36),A=e(38),h=e(40),P=e(44),S=e(5),b=d(g);l.get("/swagger.json",function(r,t){t.setHeader("Content-Type","application/json"),t.send(b)}),l.use(n.urlencoded({extended:!1})),l.use(n.json()),l.use(o.json()),l.use(i()),l.use(u()),l.use(a()),l.use("/api-docs",c.serve,c.setup(b)),l.use("/departments",p),l.use("/categories",_),l.use("/attributes",E),l.use("/products",m),l.use("/orders",S,y),l.use("/shipping/regions",f),l.use("/tax",A),l.use("/customer",h),l.use("/shoppingcart",P),l.use(function(r,t,e){e(s(500))}),l.use(function(r,t,e,s){e.locals.message=r.message,e.locals.error="DEV"===t.app.get("env")?r:{},e.status(500),e.send({message:r.message})}),r.exports=l},function(r,t){r.exports=require("http-errors")},function(r,t){r.exports=require("path")},function(r,t){r.exports=require("body-parser")},function(r,t){r.exports=require("compression")},function(r,t){r.exports=require("helmet")},function(r,t){r.exports=require("cors")},function(r,t){r.exports=require("swagger-ui-express")},function(r,t){r.exports=require("swagger-jsdoc")},function(r,t,e){e(6).config();const s={swaggerDefinition:{info:{title:"Swagger API for eCommerce Website",version:"1.0.0",description:"Endpoints for turing eCommerce website"},host:process.env.HostName,basePath:"/",securityDefinitions:{UserSecurity:{type:"apiKey",name:"User-Key",scheme:"bearer",in:"header"}},schemes:["http"]},apis:["./routes/*.js"]};r.exports=s},function(r,t,e){const s=e(2).Router(),o=e(21);s.get("/",o.getAllDepartments),s.get("/:department_id",o.getSingleDepartment),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0),u=e(23);r.exports={getAllDepartments:function(r,t,e){s.query(u.departmentsSP.getAllDepartments,function(r,e,s){r?(o.error("Error in get all departments controller : "+r),t.status(n.Errors.department.DEP_00.status).send(n.Errors.department.DEP_00)):t.status(200).send(e[0])})},getSingleDepartment:function(r,t,e){try{var a=new Number(r.params.department_id);NaN==a&&(o.error("Error in get one department controller : "+err),t.status(n.Errors.department.DEP_01.status).send(n.Errors.department.DEP_01))}catch(r){o.error("Error in get one department controller : "+err),t.status(n.Errors.department.DEP_01.status).send(n.Errors.department.DEP_01)}s.query(u.departmentsSP.getSingleDepartment+"("+a+")",function(r,e,s){r?(o.error("Error in get one department controller : "+r),t.status(n.Errors.department.DEP_00.status).send(n.Errors.department.DEP_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.department.DEP_02.status).send(n.Errors.department.DEP_02)})}}},function(r,t){r.exports=require("fs")},function(r,t){r.exports={departmentsSP:{getAllDepartments:"CALL catalog_get_departments",getSingleDepartment:"CALL catalog_get_department_details"}}},function(r,t,e){const s=e(2).Router(),o=e(25);s.get("/",o.getAllCategory),s.get("/:category_id",o.getSingleCategory),s.get("/inProduct/:product_id",o.getProductCategory),s.get("/inDepartment/:department_id",o.getDepartmentCategories),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0),u=e(26),a=e(4);r.exports={getAllCategory:function(r,t,e){let u=0,i=10,c=0;var d="Select count(*) as count from ??";d=a.format(d,["category"]),s.query(d,function(e,d,g){if(e)o.error("Error in get all Category controller : "+e),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00);else{c=d[0].count,u=void 0===r.query.page?0:parseInt(r.query.page);var l="Select * from ?? ORDER BY category_id DESC limit ? OFFSET ?",p=["category",i=void 0===r.query.limit?20:parseInt(r.query.limit),u];l=a.format(l,p),s.query(l,function(r,e){r?(o.error("Error in get all Category controller : "+r),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00)):t.status(200).send({Count:c,rows:e})})}})},getSingleCategory:function(r,t,e){try{var a=new Number(r.params.category_id);NaN==a&&(o.error("Error in get one category controller : "+err),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00))}catch(r){o.error("Error in get one category controller : "+err),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00)}s.query(u.categorySP.getSingleCategory+"("+a+")",function(r,e,s){r?(o.error("Error in get one category controller : "+r),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.category.CAT_01.status).send(n.Errors.category.CAT_01)})},getProductCategory:function(r,t,e){try{var a=new Number(r.params.product_id);NaN==a&&(o.error("Error in get Product category controller : "+err),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00))}catch(r){o.error("Error in get product category controller : "+err),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00)}s.query(u.categorySP.getProductCategory+"("+a+")",function(r,e,s){r?(o.error("Error in get product category controller : "+r),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.category.CAT_01.status).send(n.Errors.category.CAT_01)})},getDepartmentCategories:function(r,t,e){try{var a=new Number(r.params.department_id);NaN==a&&(o.error("Error in get Department category controller : "+err),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00))}catch(r){o.error("Error in get Department category controller : "+err),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00)}s.query(u.categorySP.getDepartmentCategories+"("+a+")",function(r,e,s){r?(o.error("Error in get department category controller : "+r),t.status(n.Errors.category.CAT_00.status).send(n.Errors.category.CAT_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.category.CAT_01.status).send(n.Errors.category.CAT_01)})}}},function(r,t){r.exports={categorySP:{getAllCategories:"CALL catalog_get_categories",getSingleCategory:"CALL catalog_get_category_details",getProductCategory:"CALL catalog_get_categories_for_product",getDepartmentCategories:"CALL catalog_get_categories_list"}}},function(r,t,e){const s=e(2).Router(),o=e(28);s.get("/",o.getAllAttributes),s.get("/:attribute_id",o.getSingleAttribute),s.get("/values/:attribute_id",o.getValuesAttribute),s.get("/inProduct/:product_id",o.getAllAttributesWithProductID),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0),u=e(29);e(4);r.exports={getAllAttributes:function(r,t,e){s.query(u.attributeSP.getAllAttributes,function(r,e,s){r?(o.error("Error in get all attributes controller : "+r),t.status(n.Errors.department.DEP_00.status).send(n.Errors.department.DEP_00)):t.status(200).send(e[0])})},getSingleAttribute:function(r,t,e){try{var a=new Number(r.params.attribute_id);NaN==a&&(o.error("Error in get one attribute controller : "+err),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.attribute.ATT_00))}catch(r){o.error("Error in get one attribute controller : "+err),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.attribute.ATT_00)}s.query(u.attributeSP.getSingleAttribute+"("+a+")",function(r,e,s){r?(o.error("Error in get one attribute controller : "+r),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.category.ATT_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.attribute.ATT_01.status).send(n.Errors.attribute.ATT_01)})},getValuesAttribute:function(r,t,e){try{var a=new Number(r.params.attribute_id);NaN==a&&(o.error("Error in get Values attribute controller : "+err),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.attribute.ATT_00))}catch(r){o.error("Error in get Values attribute controller : "+err),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.attribute.ATT_00)}s.query(u.attributeSP.getValuesAttribute+"("+a+")",function(r,e,s){r?(o.error("Error in get Values attribute controller : "+r),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.attribute.ATT_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.attribute.ATT_01.status).send(n.Errors.attribute.ATT_01)})},getAllAttributesWithProductID:function(r,t,e){try{var a=new Number(r.params.product_id);NaN==a&&(o.error("Error in get product attribute controller : "+err),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.attribute.ATT_00))}catch(r){o.error("Error in get product attribute controller : "+err),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.attribute.ATT_00)}s.query(u.attributeSP.getAttributesWithProductID+"("+a+")",function(r,e,s){r?(o.error("Error in get product attribute controller : "+r),t.status(n.Errors.attribute.ATT_00.status).send(n.Errors.attribute.ATT_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.attribute.ATT_01.status).send(n.Errors.attribute.ATT_01)})}}},function(r,t){r.exports={attributeSP:{getAllAttributes:"CALL catalog_get_attributes",getSingleAttribute:"CALL catalog_get_attribute_details",getValuesAttribute:"CALL catalog_get_attribute_values",getAttributesWithProductID:"CALL catalog_get_product_attributes"}}},function(r,t,e){const s=e(2).Router(),o=e(31),n=e(5);s.get("/",o.getAllProducts),s.get("/search",o.searchProducts),s.get("/:product_id",o.getProductByID),s.get("/inCategory/:category_id",o.getProductByCategory),s.get("/inDepartment/:department_id",o.getProductByDepartment),s.get("/:product_id/details",o.getProductDetails),s.get("/:product_id/locations",o.getProductLocations),s.get("/:product_id/reviews",o.getProductReviews),s.post("/:product_id/review",n,o.postProductReviews),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0),u=e(32),a=e(4);r.exports={getAllProducts:function(r,t,e){let a=1,i=20,c=200,d=0;a=void 0===r.query.page?1:parseInt(r.query.page),i=void 0===r.query.limit?20:parseInt(r.query.limit),c=void 0===r.query.descLimit?200:parseInt(r.query.descLimit);var g=u.productsSP.getAllProducts+"("+c+","+i+","+a+")";s.query(g,function(r,e){r?(o.error("Error in get all products controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):(d=e[0].length,t.status(200).send({Count:d,rows:e[0]}))})},searchProducts:function(r,t,e){let u="%"+r.query.query_string+"%",i=1,c=20,d=0;i=void 0===r.query.page?0:parseInt(r.query.page),c=void 0===r.query.limit?20:parseInt(r.query.limit),void 0===r.query.descLimit?descLimit=200:descLimit=parseInt(r.query.descLimit);var g="SELECT * FROM product WHERE name LIKE ? ORDER BY ? DESC LIMIT ?",l=[u,i,c];g=a.format(g,l),s.query(g,function(r,e){r?(o.error("Error in search products controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):(d=e[0].length,t.status(200).send({Count:d,rows:e}))})},getProductByID:function(r,t,e){try{var a=new Number(r.params.product_id);NaN==a&&(o.error("Error in get one product controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01))}catch(r){o.error("Error in get one product controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01)}s.query(u.productsSP.getSingleProduct+"("+a+")",function(r,e,s){r?(o.error("Error in get one product controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01)})},getProductByCategory:function(r,t,e){let a=r.params.category_id,i=1,c=20,d=0;i=void 0===r.query.page?0:parseInt(r.query.page),c=void 0===r.query.limit?20:parseInt(r.query.limit),void 0===r.query.descLimit?descLimit=200:descLimit=parseInt(r.query.descLimit);var g=u.productsSP.getProductsByCategory+"("+a+","+descLimit+","+c+","+i+")";s.query(g,function(r,e){r?(o.error("Error in get products by category controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):(d=e[0].length,t.status(200).send({Count:d,rows:e}))})},getProductByDepartment:function(r,t,e){let a=r.params.department_id,i=1,c=20,d=0;i=void 0===r.query.page?0:parseInt(r.query.page),c=void 0===r.query.limit?20:parseInt(r.query.limit),void 0===r.query.descLimit?descLimit=200:descLimit=parseInt(r.query.descLimit);var g=u.productsSP.getProductsByDepartment+"("+a+","+descLimit+","+c+","+i+")";s.query(g,function(r,e){r?(o.error("Error in get products by department controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):(d=e[0].length,t.status(200).send({Count:d,rows:e}))})},getProductDetails:function(r,t,e){try{var a=new Number(r.params.product_id);NaN==a&&(o.error("Error in get product details controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01))}catch(r){o.error("Error in get product details controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01)}s.query(u.productsSP.getProductDetails+"("+a+")",function(r,e,s){r?(o.error("Error in get product details controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01)})},getProductLocations:function(r,t,e){try{var a=new Number(r.params.product_id);NaN==a&&(o.error("Error in get product locations controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01))}catch(r){o.error("Error in get product locations controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01)}s.query(u.productsSP.getProductLocations+"("+a+")",function(r,e,s){r?(o.error("Error in get product locations controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01)})},getProductReviews:function(r,t,e){try{var a=new Number(r.params.product_id);NaN==a&&(o.error("Error in get product reviews controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01))}catch(r){o.error("Error in get product reviews controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01)}s.query(u.productsSP.getProductReviews+"("+a+")",function(r,e,s){r?(o.error("Error in get product reviews controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01)})},postProductReviews:function(r,t,e){try{let e=new Number(r.params.product_id);if(NaN==e)o.error("Error in POST product reviews controller : "+err),t.status(n.Errors.products.PRO_01.status).send(n.Errors.products.PRO_01);else{let a=r.user.customer_id,i=r.body.review,c=r.body.rating;s.query(u.productsSP.postProductReview+"("+a+","+e+",'"+i+"','"+c+"')",function(r,e,s){r?(o.error("Error in post product reviews controller : "+r),t.status(n.Errors.products.PRO_00.status).send(n.Errors.products.PRO_00)):t.status(200).send("Data Saved")})}}catch(r){o.error("Error, Unauthorized user : "+r),t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)}}}},function(r,t){r.exports={productsSP:{getAllProducts:"CALL catalog_get_products_on_catalog",getSingleProduct:"CALL catalog_get_product_info",getProductsByCategory:"CALL catalog_get_products_in_category",getProductsByDepartment:"CALL catalog_get_products_on_department",getProductDetails:"CALL catalog_get_product_details",getProductLocations:"CALL catalog_get_product_locations",getProductReviews:"CALL catalog_get_product_reviews",postProductReview:"CALL catalog_create_product_review"}}},function(r,t,e){const s=e(2).Router(),o=e(34);s.post("/",o.postOrders),s.get("/:order_id/",o.getSingleOrder),s.get("/a/inCustomer",o.getCustomerOrder),s.get("/shortDetail/:order_id",o.getOrderInfo),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0),u=e(35);e(4);r.exports={postOrders:function(r,t,e){try{let e="",a="",i=r.body.cart_id,c=r.body.shipping_id,d=r.body.tax_id;r.user?(e=r.user.customer_id,a=u.ordersSP.postOrder+"("+i+","+e+","+c+","+d+")",s.query(a,function(r,e,s){r?(o.error("Error in post order controller : "+r),t.status(n.Errors.orders.ORD_00.status).send(n.Errors.orders.ORD_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.orders.ORD_01.status).send(n.Errors.orders.ORD_01)})):(o.error("Error in post order controller, unauthorized : "+err),t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02))}catch(r){o.error("Error, Unauthorized user : "+r),t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)}},getSingleOrder:function(r,t,e){if(r.user)try{var a=new Number(r.params.order_id),i=u.ordersSP.getSingleOrder+"("+a+")";s.query(i,function(r,e,s){r?(o.error("Error in get one order controller : "+r),t.status(n.Errors.orders.ORD_00.status).send(n.Errors.orders.ORD_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.orders.ORD_01.status).send(n.Errors.orders.ORD_01)})}catch(r){o.error("Error in get one order controller : "+err),t.status(n.Errors.orders.ORD_01.status).send(n.Errors.orders.ORD_01)}else o.error("Error in get one order controller : Unauthorized"),t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)},getCustomerOrder:function(r,t,e){try{if(r.user){var a=r.user.customer_id;s.query(u.ordersSP.getCustomerOrder+"("+a+")",function(r,e,s){r?(o.error("Error in get customer order controller : "+r),t.status(n.Errors.orders.ORD_00.status).send(n.Errors.orders.ORD_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.orders.ORD_01.status).send(n.Errors.orders.ORD_01)})}else o.error("Error in get customer order controller, unauthorized"),t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)}catch(r){o.error("Error in get customer order controller : "+err),t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)}},getOrderInfo:function(r,t,e){try{var a=new Number(r.params.order_id);NaN==a&&(o.error("Error in get order info controller : "+err),t.status(n.Errors.orders.ORD_01.status).send(n.Errors.orders.ORD_01))}catch(r){o.error("Error in get one order controller : "+err),t.status(n.Errors.orders.ORD_01.status).send(n.Errors.orders.ORD_01)}s.query(u.ordersSP.getOrderDetails+"("+a+")",function(r,e,s){r?(o.error("Error in get one order controller : "+r),t.status(n.Errors.orders.ORD_00.status).send(n.Errors.orders.ORD_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.orders.ORD_01.status).send(n.Errors.orders.ORD_01)})}}},function(r,t){r.exports={ordersSP:{postOrder:"CALL shopping_cart_create_order",getSingleOrder:"CALL orders_get_order_details",getCustomerOrder:"CALL orders_get_by_customer_id",getOrderDetails:"CALL orders_get_order_info"}}},function(r,t,e){const s=e(2).Router(),o=e(37);s.get("/",o.getAllShippingRegions),s.get("/:shipping_region_id",o.getSingleShippingRegion),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0);r.exports={getAllShippingRegions:function(r,t,e){s.query("CALL customer_get_shipping_regions ()",function(r,e,s){r?(o.error("Error in get all shipping region controller : "+r),t.status(n.Errors.shipping.SHP_00.status).send(n.Errors.shipping.SHP_00)):t.status(200).send(e[0])})},getSingleShippingRegion:function(r,t,e){try{var u=new Number(r.params.shipping_region_id);NaN==u&&(o.error("Error in get one shipping region controller : "+err),t.status(n.Errors.shipping.SHP_01.status).send(n.Errors.shipping.SHP_01))}catch(r){o.error("Error in get one shipping region controller : "+err),t.status(n.Errors.shipping.SHP_01.status).send(n.Errors.shipping.SHP_01)}s.query("SELECT * FROM shipping_region where shipping_region_id = "+u,function(r,e,s){r?(o.error("Error in get one shipping region controller : "+r),t.status(n.Errors.shipping.SHP_00.status).send(n.Errors.shipping.SHP_00)):e[0].length>0?t.status(200).send(e[0]):t.status(n.Errors.shipping.SHP_01.status).send(n.Errors.shipping.SHP_01)})}}},function(r,t,e){const s=e(2).Router(),o=e(39);s.get("/",o.getAllTax),s.get("/:tax_id",o.getSingleTax),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0);r.exports={getAllTax:function(r,t,e){s.query("SELECT * FROM tax",function(r,e,s){r?(o.error("Error in get all tax controller : "+r),t.status(n.Errors.tax.TAX_00.status).send(n.Errors.tax.TAX_00)):t.status(200).send(e[0])})},getSingleTax:function(r,t,e){try{var u=new Number(r.params.tax_id);NaN==u&&(o.error("Error in get one tax controller : "+err),t.status(n.Errors.tax.TAX_01.status).send(n.Errors.tax.TAX_01))}catch(r){o.error("Error in get one tax controller : "+err),t.status(n.Errors.tax.TAX_01.status).send(n.Errors.tax.TAX_01)}s.query("SELECT * FROM tax where tax_id = "+u,function(r,e,s){r?(o.error("Error in get one tax controller : "+r),t.status(n.Errors.tax.TAX_00.status).send(n.Errors.tax.TAX_00)):e[0]?t.status(200).send(e[0]):t.status(n.Errors.tax.TAX_01.status).send(n.Errors.tax.TAX_01)})}}},function(r,t,e){const s=e(2).Router(),o=e(41),n=e(5);s.get("/",n,o.getCustomerByID),s.post("/login",o.loginCtrl),s.post("/",o.registerCtrl),s.put("/",n,o.putCustomerCtrl),s.put("/address",n,o.putAddressCtrl),s.put("/creditCard",n,o.putCreditCard),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0),u=e(42),a=e(8),i=e(43);r.exports={getCustomerByID:function(r,t,e){if(r.user){let e=u.customersSP.getCustomerByID+"("+r.user.customer_id+")";s.query(e,function(r,e,s){r?(o.error("Error in get customer by ID controller : "+r),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)):t.status(200).send(e[0])})}else t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)},loginCtrl:function(r,t,e){let c=r.body.email,d=u.customersSP.getLoginDetails+"('"+c+"')";s.query(d,(e,s)=>{e?(o.error("Error in Login customer controller : "+e),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)):s[0].length>0?i.compare(r.body.password,s[0][0].password,(r,e)=>{if(r)o.error("Error in Login customer controller, Passwords don't match : "+r),t.status(n.Errors.customer.USR_01.status).send(n.Errors.customer.USR_01);else if(e){let r=a.sign({email:c,customer_id:s[0][0].customer_id},process.env.jwtSecretKey,{expiresIn:"24h"});t.status(200).send({success:!0,message:"Authentication successful!",token:r})}else o.error("Error in Login customer controller : Email/password don't match"),t.status(n.Errors.customer.USR_01.status).send(n.Errors.customer.USR_01)}):(o.error("Error in Login customer controller : "+e),t.status(n.Errors.customer.USR_05.status).send(n.Errors.customer.USR_05))})},registerCtrl:function(r,t,e){try{let e=i.hashSync(r.body.password,10),c=(a=r.body.email,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(a).toLowerCase())),d=e,g=r.body.name;if(c){let e=r.body.email,a=u.customersSP.registerCustomer+"('"+g+"','"+e+"','"+d+"')",i="SELECT * FROM customer where email = '"+e+"'";s.query(i,function(r,e){r?(o.error("Error in register customer controller : "+r),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)):e.length>0?(o.error("Error in register customer controller, email alredy exist : "),t.status(n.Errors.customer.USR_04.status).send(n.Errors.customer.USR_04)):s.query(a,function(r,e,s){r?(o.error("Error in register customer controller : "+r),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)):t.status(200).send(e[0])})})}else o.error("Error in register customer controller : email id incorrect "),t.status(n.Errors.customer.USR_03.status).send(n.Errors.customer.USR_03)}catch(r){o.error("Error in register customer controller : "+r),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)}var a},putCustomerCtrl:function(r,t,e){try{if(r.user){let e=i.hashSync(r.body.password,10),a=new Number(r.user.customer_id),c=r.body.name,d=r.body.email,g=r.body.day_phone,l=r.body.eve_phone,p=r.body.mob_phone;const _=u.customersSP.updateCustomer+"("+a+",'"+c+"','"+d+"','"+e+"','"+g+"','"+l+"','"+p+"')";s.query(_,(r,e)=>{r?(o.error("Error in update customer by ID controller : "+r),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)):t.status(200).send(e[0])})}else t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)}catch(r){o.error("Error in update customer by ID controller : "+r),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)}},putAddressCtrl:function(r,t,e){if(r.user){let e=new Number(r.user.customer_id),a=r.body.address_1,i=r.body.address_2,c=r.body.city,d=new Number(r.body.shipping_region_id),g=r.body.region,l=r.body.postal_code,p=r.body.country;const _=u.customersSP.updateAddress+"("+e+",'"+a+"','"+i+"','"+c+"','"+g+"','"+l+"','"+p+"','"+d+"')";s.query(_,(r,e)=>{r?(o.error("Error in update Address by ID controller : "+r),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)):t.status(200).send(e[0])})}else t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)},putCreditCard:function(r,t,e){if(r.user){let e=new Number(r.user.customer_id),a=r.body.credit_card;const i=u.customersSP.updateCreditCard+"("+e+",'"+a+"')";s.query(i,(r,e)=>{r?(o.error("Error in update Credit Card by ID controller : "+r),t.status(n.Errors.customer.USR_00.status).send(n.Errors.customer.USR_00)):t.status(200).send(e[0])})}else t.status(n.Errors.Auth.AUT_02.status).send(n.Errors.Auth.AUT_02)}}},function(r,t){r.exports={customersSP:{getCustomerByID:"CALL customer_get_customer",registerCustomer:"CALL customer_add",getLoginDetails:"CALL customer_get_login_info",updateCustomer:"CALL customer_update_account",updateAddress:"CALL customer_update_address",updateCreditCard:"CALL customer_update_credit_card"}}},function(r,t){r.exports=require("bcryptjs")},function(r,t,e){const s=e(2).Router(),o=e(45);s.get("/generateUniqueId",o.generateUniqueID),s.post("/add",o.addProduct),r.exports=s},function(r,t,e){const s=e(3),o=e(1).Logger,n=e(0),u=e(46);r.exports={generateUniqueID:function(r,t,e){let u=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),a='INSERT INTO shopping_cart(cart_id) Values ("'+u+'")';s.query(a,(r,e)=>{r?(o.error("Error in Generate Unique Cart ID controller : "+r),t.status(n.Errors.shopping_cart.SHC_00.status).send(n.Errors.shopping_cart.SHC_00)):t.status(200).send({"cart_id ":u})})},addProduct:function(r,t,e){let a=r.body.cart_id,i=r.body.product_id,c=r.body.attributes;const d=u.addProduct+"('"+a+"',"+i+",'"+c+"')";s.query(d,(r,e)=>{r?(o.error("Error in add products in Cart controller : "+r),t.status(n.Errors.shopping_cart.SHC_00.status).send(n.Errors.shopping_cart.SHC_00)):t.status(200).send(e[0])})}}},function(r,t){r.exports={addProduct:"CALL shopping_cart_add_product"}},function(r,t){r.exports=require("debug")},function(r,t){r.exports=require("http")}]);